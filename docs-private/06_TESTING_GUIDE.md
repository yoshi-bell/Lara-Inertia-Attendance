# 🟢 メタ定義: このファイルの責務 (AIエージェント用)
> **AIエージェントへの指示 (Prompt Repetition Strategy):** 
> このファイルは「品質保証とテストの書き方」の正解を定義しています。
> テストコードの実装、テスト環境の構築、バグ修正時の回帰テスト作成時に必ず読み込んでください。

*   **役割:** テスト戦略、Pest/Vitest/Playwright の使い分け、モック戦略の定義。
*   **読むべきタイミング:** テスト作成時、CI環境構築時、バグ調査時。

---

# Lara-Inertia-Attendance テスト指針 (Testing Guide)

## 🧪 テスト戦略と使い分け

### 1. Backend: 統合テスト (Pest / PHPUnit)
*   **検証:** `assertInertia` を使用し、コントローラーが正しい React コンポーネントを呼び出し、期待通りのデータ（Props）を渡しているかを厳密に検証する。
*   **優先順位:** 異常系（認可ガード、バリデーション）の網羅。

### 2. Frontend: 単体・コンポーネントテスト (Vitest / Testing Library)
*   **検証:** 複雑なロジック、動的な UI レンダリング、Props による挙動の変化。
*   **ベストプラクティス:** `within` や `getByRole` を使用し、実装詳細に依存しない堅牢なテストを書く。

### 3. End-to-End テスト (Playwright)
*   **目的:** ログイン、打刻、承認などの主要ワークフローの完走保証。
*   **実行:** `npx playwright test`。データ競合回避のため、必要に応じて `--workers=1` で実行。

---

## 🛠️ 型安全なテスト
*   テストコードにおいても `any` を排除し、適切なモック型を定義する。
*   **例外的な any の許容:** 
    *   外部ライブラリの型定義が極めて複雑な場合に限り、実利的な判断として `any` を許容する。
    *   その際は必ず `// eslint-disable-next-line @typescript-eslint/no-explicit-any` を添えて、意図的な使用であることを明示すること。
*   **「型を完璧に合わせること」よりも「テストが網羅されていること」を優先する**実利的な判断も許容する。
